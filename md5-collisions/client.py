import json
import urllib.request
import urllib.parse
import urllib.error
from base64 import b16decode
from base64 import b16encode

BASE_URL = "http://pac.bouillaguet.info/TP2/"
ENCODING = 'utf-8'

class ServerError(Exception):
    def __init__(self, code=None, msg=None):
        self.code = code
        self.msg = None

class Server:
    def __init__(self, base_url):
        self.base = base_url

    def query(self, url, parameters=None ):
         url = self.base + url
         try:
            request = urllib.request.Request(url)
            data = None
            if parameters is not None:
                data = json.dumps(parameters).encode()
                request.add_header('Content-type', 'application/json')
            with urllib.request.urlopen(request, data) as connexion:
                result = connexion.read().decode()
                if connexion.info()['Content-Type'] == "application/json":
                    result = json.loads(result)
            return result
         except urllib.error.HTTPError as e:
             raise ServerError(e.code, e.read().decode()) from None

if __name__ == "__main__":
  server = Server(BASE_URL)

  #parameters = { '0': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead3350d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab04b7b3cec5371f69d3e1cd0ac18c853b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb3244c0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779588dd750846c571d9df74636180a03591711e16550414320504f574141414141414141414141', '1': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead33d0d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab0cb7b3cec5371f69d3e1cd0ac18c8d3b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb324cc0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779580dd750846c571d9df74636180a03d91711e16550414320504f574141414141414141414141' }

  parameters = { '0': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead3350d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab04b7b3cec5371f69d3e1cd0ac18c853b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb3244c0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779588dd750846c571d9df74636180a03591711e165728509bcf78da5b72df673691d6265fa87bcb5650ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f00704ca4b41f6c48d2b42a85214a7961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b92fe0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0766a869e138d332cac1562e29b1d76d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb592985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd1dd971a82fcba139e222f31184d358373a410f860ee97718abef4b8a5811d589aad2428133325bd74d991d94bc31070ba5f68c7cf9518f497851d367403867a2e54199b3a5c36275b41c945b58f9fd3b593797f50414320504f574141414141414141414141',
  '1': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead3350d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab04b7b3cec5371f69d3e1cd0ac18c853b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb3244c0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779588dd750846c571d9df74636180a03591711e165728509bcf78da5b72df673691d6265fa87bcb5650ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f00704ca4b41f6c48d2b42a85214a7961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b92fe0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0766a869e138d332cac1562e29b1d76d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb512985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd15d981a82fcba139e222f31184d350373a410f860ee97718abef4b8a5811d589aad24281333253d74d991d94bc31070ba5f68c7cf9518f497851d367403867a2ed4189b3a5c36275b41c945b58f9f53b593797f50414320504f574141414141414141414141',
  '2': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead3350d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab04b7b3cec5371f69d3e1cd0ac18c853b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb3244c0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779588dd750846c571d9df74636180a03591711e165728509bcf78da5b72df673691d6265fa87bcb5e50ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f80704ca4b41f6c48d2b42a85214af961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b927e0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0f669869e138d332cac1562e29b1df6d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb592985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd1dd971a82fcba139e222f31184d358373a410f860ee97718abef4b8a5811d589aad2428133325bd74d991d94bc31070ba5f68c7cf9518f497851d367403867a2e54199b3a5c36275b41c945b58f9fd3b593797f50414320504f574141414141414141414141',
  '3': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead3350d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab04b7b3cec5371f69d3e1cd0ac18c853b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb3244c0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779588dd750846c571d9df74636180a03591711e165728509bcf78da5b72df673691d6265fa87bcb5e50ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f80704ca4b41f6c48d2b42a85214af961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b927e0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0f669869e138d332cac1562e29b1df6d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb512985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd15d981a82fcba139e222f31184d350373a410f860ee97718abef4b8a5811d589aad24281333253d74d991d94bc31070ba5f68c7cf9518f497851d367403867a2ed4189b3a5c36275b41c945b58f9f53b593797f50414320504f574141414141414141414141',
  '4': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead33d0d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab0cb7b3cec5371f69d3e1cd0ac18c8d3b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb324cc0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779580dd750846c571d9df74636180a03d91711e165728509bcf78da5b72df673691d6265fa87bcb5650ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f00704ca4b41f6c48d2b42a85214a7961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b92fe0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0766a869e138d332cac1562e29b1d76d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb592985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd1dd971a82fcba139e222f31184d358373a410f860ee97718abef4b8a5811d589aad2428133325bd74d991d94bc31070ba5f68c7cf9518f497851d367403867a2e54199b3a5c36275b41c945b58f9fd3b593797f50414320504f574141414141414141414141',
  '5': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead33d0d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab0cb7b3cec5371f69d3e1cd0ac18c8d3b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb324cc0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779580dd750846c571d9df74636180a03d91711e165728509bcf78da5b72df673691d6265fa87bcb5650ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f00704ca4b41f6c48d2b42a85214a7961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b92fe0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0766a869e138d332cac1562e29b1d76d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb512985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd15d981a82fcba139e222f31184d350373a410f860ee97718abef4b8a5811d589aad24281333253d74d991d94bc31070ba5f68c7cf9518f497851d367403867a2ed4189b3a5c36275b41c945b58f9f53b593797f50414320504f574141414141414141414141',
  '6': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead33d0d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab0cb7b3cec5371f69d3e1cd0ac18c8d3b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb324cc0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779580dd750846c571d9df74636180a03d91711e165728509bcf78da5b72df673691d6265fa87bcb5e50ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f80704ca4b41f6c48d2b42a85214af961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b927e0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0f669869e138d332cac1562e29b1df6d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb592985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd1dd971a82fcba139e222f31184d358373a410f860ee97718abef4b8a5811d589aad2428133325bd74d991d94bc31070ba5f68c7cf9518f497851d367403867a2e54199b3a5c36275b41c945b58f9fd3b593797f50414320504f574141414141414141414141',
  '7': '736f6d6d65726172643031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132330a68a613f7d8a8f7d7b4a8be8a819ec72c0ead33d0d5fa38f9470a78c2d72caf74e2bbc00c5ea5b4a6ef254efab0cb7b3cec5371f69d3e1cd0ac18c8d3b6d3dd190733933a9316b1d3b1c13a42ea2de56ddbb324cc0a88732a74abbfcb4f8d2d41d98bb16d07a57ad7da9c6779580dd750846c571d9df74636180a03d91711e165728509bcf78da5b72df673691d6265fa87bcb5e50ebc55911cb6785a10c00726532beec6ecac3c460f087ad31f80704ca4b41f6c48d2b42a85214af961b1b5cd94c558f2844e8dea89c8ec1b97461b23e60b927e0b7a211ec95715cdd57159227f679fde7127afe6c564c48fa0f669869e138d332cac1562e29b1df6d7ce7c076a26aa19621243b63c0a2c8ee9588fc6da7cb512985b3c700942414aca960ee2e3c3afeb7cb049328fd0d63cd15d981a82fcba139e222f31184d350373a410f860ee97718abef4b8a5811d589aad24281333253d74d991d94bc31070ba5f68c7cf9518f497851d367403867a2ed4189b3a5c36275b41c945b58f9f53b593797f50414320504f574141414141414141414141'}
  response = server.query('/md5-collisions/checker/sommerard', parameters)
  print(response)
